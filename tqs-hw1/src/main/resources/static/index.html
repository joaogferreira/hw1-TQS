<html>
<head>
    <title>Air Quality</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>

<script type = "text/javascript">
    function start() {
        const drop = document.getElementById('city');
        const json = fetch("http://localhost:8080/api/stations")
            .then((resp) => resp.json())
            .then(function (data) {
                for (id in data) {
                    const aux = data[id];
                    const city = aux["city"];
                    const option = document.createElement('option');
                    option.innerHTML = city;
                    option.value = id;
                    drop.appendChild(option);
                }
                ;
            })
    }


    function callAPI() {
        console.log("CALL API");
        const citySelect = document.getElementById("city");
        console.log(citySelect);
        const city = citySelect.options[citySelect.selectedIndex].text;
        console.log(city.valueOf());
        var json = fetch("http://localhost:8080/api/air/"+ city.toLowerCase())
            .then((resp) => resp.json())
            .then(function (data) {
                //document.getElementById("forecastDate").textContent = data["data"][day]["forecastDate"];
                //document.getElementById("minTemp").textContent = data["data"][day]["tMin"];
                //document.getElementById("maxTemp").textContent = data["data"][day]["tMax"];
                //document.getElementById("windDirec").textContent = data["data"][day]["predWindDir"];
            })
    }
</script>


<body onload="start()">
<div>
    <h1>Air Quality App</h1>
</div>
<div>
    <b>City: </b>
    <select id="city"></select>
    <button onclick="callAPI()">OK</button>
</div>
</body>

</html>
